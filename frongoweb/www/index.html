$def with (data)

$var title: Frongo.



<div class="row clearfix">
	<div class="col-md-12 column">
		<div class="panel panel-default">
		  	<div class="panel-heading">
		    	<h3 class="panel-title">
		    		Frongo 
		    	</h3>
		  	</div>
		  	<div class="panel-body">
			  	<div class="form-group">
						<div class="dropdown">
						  <button id="model" class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">
						  	Model
						  	<span class="caret"></span>
						  </button>
						  <ul class="dropdown-menu">
								$for q in data['queries']:
							    	<li><a value="$q">$q</a></li>
						  </ul>
						</div>
					</div>
					<div class="input-group">
						<span class="input-group-addon">|<-</span>
						<input type="text" class="form-control form_datetime" id="from" placeholder="From" aria-describedby="from">

						<span class="input-group-addon">->|</span>
						<input type="text" class="form-control form_datetime" id="to" placeholder="To" aria-describedby="to">
					</div>

				<div>
						<div class="row clearfix">
							<div class="col-md-12 column">
								<div class="panel panel-default">
								  	<div class="panel-heading">
								    	<h3 class="panel-title">
										    Frongo Predictions
								    	</h3>
								  	</div>
								  	<div class="panel-body">
								  		<div id="histogram" >
									  		<canvas style="padding: 0;
															margin: auto;
															display: block;
															width: 600px;" id="resultChart" width="500" height="300"></canvas>
							                                <p><div id="legend"></div></p>
										</div>
								  	</div>
							  	</div>

							</div>
						</div>



		  	</div>
		</div>
	</div>
</div>

<script type="text/javascript">
		function display_chart(data) {
			var ctx = document.getElementById("resultChart").getContext("2d");

			if( window.chart_obj!==undefined)
     			window.chart_obj.destroy();	
			window.chart_obj = new Chart(ctx).Line(data, {legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li style=\"color:<%=datasets[i].strokeColor%>\"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>",
			    animation: false
			});
			$$("div#legend").html(window.chart_obj.generateLegend());

		}


		function update_chart(data) {
			// Get the context of the canvas element we want to select

			display_chart(data);
		}


		$$(document).ready(function () {

				Chart.defaults.global.responsive = true;

			}
		);


		//$$(".form_datetime").datetimepicker({format: 'yyyy-mm-dd hh:ii'});
		$$(".form_datetime").datetimepicker({format: "$data['datetime_format']"});


		function query() {
			console.log("query");
			console.log($$("#model").val());


			$$.getJSON("/query", {
					model: $$("#model").val(),
					epoch_from: $$("#from").val(),
					epoch_to: $$("#to").val()
				}, function (data) {
			    update_chart(data);
			  }
			);


		}

		$$(".form_datetime").change(function(){
			query();
		});


		$$(".dropdown-menu li a").click(function(){
		  $$(this).parents(".dropdown").find('.btn').html($$(this).text() + ' <span class="caret"></span>');
		  $$(this).parents(".dropdown").find('.btn').val($$(this).text());

		  query();
		});
</script>

